---
title: "Test PHOIBLE features"
author: "Steven Moran \\<steven.moran@uzh.ch\\>"
output: github_document
---

```{r}
library(testthat)
library(dplyr)
```

```{r}  
load('/Users/stiv/Github/phoible/data/phoible.RData')
```

# How many distinct feature vectors are there?
```{r}
distinct.segments <- phoible %>% select(-InventoryID, -Glottocode, -ISO6393, -LanguageName, -SpecificDialect, -GlyphID, -Allophones, -Marginal, -SegmentClass, -Source) %>% distinct()
head(distinct.segments)
```


# Look at the different features' compoents

```{r}
table(phoible$tone)
```

```{r}
table(phoible$stress)
```

```{r}
table(phoible$syllabic)
```

```{r}
table(phoible$short)
```

```{r}
table(phoible$long)
```

```{r}
table(phoible$consonantal)
```

```{r}
table(phoible$sonorant)
phoible %>% filter(sonorant=="+,-,+,-")
```

```{r}
table(phoible$continuant)
phoible %>% filter(continuant=="0,0,-,+")
```

```{r}
table(phoible$delayedRelease)
phoible %>% filter(delayedRelease=="0,0,-,+")
```

```{r}
table(phoible$approximant)
```

```{r}
table(phoible$tap)
```

```{r}
table(phoible$trill)
```

```{r}
table(phoible$nasal)
```

```{r}
table(phoible$lateral)
```

```{r}
table(phoible$labial)
```

```{r}
table(phoible$round)
```

```{r}
table(phoible$labiodental)
```

```{r}
table(phoible$coronal)
```

```{r}
table(phoible$anterior)
```

```{r}
table(phoible$distributed)
```

```{r}
table(phoible$strident)
```

```{r}
table(phoible$dorsal)

# Testing a weird looking feature vector -- the segment is the same at source
phoible %>% filter(dorsal=="0,0,-,+")
```

```{r}
table(phoible$high)
```

```{r}
table(phoible$low)
```

```{r}
table(phoible$front)
```

```{r}
table(phoible$back)
```

```{r}
table(phoible$tense)
```

```{r}
table(phoible$retractedTongueRoot)
```

```{r}
table(phoible$advancedTongueRoot)
```

```{r}
table(phoible$periodicGlottalSource)
```

```{r}
table(phoible$epilaryngealSource)
```

```{r}
table(phoible$spreadGlottis)
```

```{r}
table(phoible$constrictedGlottis)
```

```{r}
table(phoible$fortis)
```

```{r}
table(phoible$raisedLarynxEjective)
```

```{r}
table(phoible$loweredLarynxImplosive)
```

```{r}
table(phoible$click)
```

## Compare features to phoible 2104

```{r}
old <- read.delim("phoible-segments-features.tsv", header=T)
glimpse(old)

x <- phoible %>% filter(Phoneme %in% old$segment) %>% select(-InventoryID, -Glottocode, -ISO6393, -LanguageName, -SpecificDialect, -GlyphID, -Allophones, -Marginal, -SegmentClass, -Source) %>% distinct()
glimpse(x)
```


# Individual spacing modifier letters and where they occur
```{r}
# epilaryngeal source (only occurs in 1379, !Xoo)
phoible %>% filter(grepl("ᴱ", Phoneme)) %>% select(InventoryID, LanguageName, Phoneme)
```

```{r}
# unaspirated
phoible %>% filter(grepl("˭", Allophones)) %>% select(InventoryID, LanguageName, Phoneme)
```
```{r}
# labial-palatalized  # TODO: should use labial+palatal?
phoible %>% filter(grepl("ᶣ", Phoneme)) %>% select(InventoryID, LanguageName, Phoneme)
```

```{r}
# schwa-like release # TODO: check what this really is
phoible %>% filter(grepl("ᵊ", Allophones)) %>% select(InventoryID, LanguageName, Phoneme, Allophones)
```

